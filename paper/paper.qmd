---
title: "Traffic Collisions in Toronto: Analysis of Key Variables"
subtitle: "An Analysis of Traffic Collision Data from 2014-2024"
author: 
  - Andy Jiang
thanks: "Code and data are available at: https://github.com/AndyYanxunJiang/toronto-traffic-collisions.git"
date: 24 September 2024
date-format: long
abstract: "This paper analyzes traffic collision data in Toronto from 2014 to 2024. It explores trends in collisions by month, year, and neighborhood, examining variables such as fatalities, injuries, and property damage. The analysis is done using @citeR, with visualizations produced through ggplot2."
format: pdf
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(knitr)
library(kableExtra)
library(opendatatoronto)
library(here)
library(tidyr)
library(dplyr)
library(janitor)
library(VennDiagram)


# Load the cleaned data
data <- read_csv(here::here("data/analysis_data/cleaned_collision_data.csv"))

# Convert relevant variables to factors
data <- data %>%
  mutate(OCC_MONTH = factor(OCC_MONTH, levels = month.name),
         INJURY_COLLISIONS = as.factor(INJURY_COLLISIONS),
         FTR_COLLISIONS = as.factor(FTR_COLLISIONS),
         PD_COLLISIONS = as.factor(PD_COLLISIONS))
```

# Introduction
This paper analyzes traffic collision data in Toronto from 2014 to 2024. We explore trends in monthly, yearly, and neighborhood-level collisions, with a focus on variables such as fatalities, injuries, property damage, and modes of transport involved. The data is sourced from Open Data Toronto and contains detailed information about each collision.

The remainder of this paper is structured as follows. Section @sec-data provides details of the dataset used in this analysis. Section @sec-results presents the results of the analysis, followed by a discussion in Section @sec-discussion. Finally, Section @sec-conclusion summarizes the key findings of the study.


# Data {#sec-data}
The dataset used in this analysis was obtained from Open Data Toronto. It includes traffic collision data collected between 2014 and 2024. The variables include the date and time of the collision, whether there were fatalities, injuries, or property damage, and the type of vehicle(s) involved. @tbl-1 provides a sample of the cleaned dataset.

```{r}
#| label: tbl-1
#| tbl-cap: Sample of the cleaned collision data
#| echo: false

# Display the cleaned collision data
head(data, 10) %>%
  
  # Use kable to format the table with custom column names
  kable(
    col.names = c(
      "Month", "Day of Week", "Year", "Hour", "Fatalities",
      "Injury Collisions", "FTR Collisions", "PD Collisions"
    ),
    align = 'c'
  )
```


# Results {#sec-results}
Here we analyze the data by looking at the frequency of traffic collisions based on various factors such as month, year, and neighborhood.

Collisions by Month
The following figure shows the distribution of collisions by month across all years.

```{r}
#| label: fig-collisions-month
#| fig-cap: Monthly traffic collision counts in Toronto from 2014 to 2024.
#| echo: false
ggplot(data, aes(x = OCC_MONTH)) +
  geom_bar(position = "dodge", stat = "count", fill = "lightblue") +
  theme_minimal() +
  labs(title = "Total Traffic Collisions by Month (2014-2024)",
       x = "Month", y = "Total Count of Collisions") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, color = "black"),
        plot.title = element_text(hjust = 0.5, size = 14))
```

```{r}
#| label: fig-collisions-hour
#| fig-cap: Total collisions by hour of the day from 2014 to 2024
#| echo: false

data$OCC_HOUR[is.na(data$OCC_HOUR)] <- 0
data %>%
  group_by(OCC_HOUR) %>%
  summarise(Total_Collisions = sum(INJURY_COLLISIONS == "YES" | 
                                     FTR_COLLISIONS == "YES" | 
                                     PD_COLLISIONS == "YES", na.rm = TRUE)) %>%
  ggplot(aes(x = OCC_HOUR, y = Total_Collisions)) +
  geom_line(color = "steelblue", size = 1) +
  theme_minimal() +
  scale_x_continuous(breaks = 0:23) +
  labs(title = "Total Traffic Collisions by Hour of the Day (2014-2024)",
       x = "Hour of the Day",
       y = "Total Number of Collisions") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        plot.title = element_text(hjust = 0.5),
        panel.grid.major.x = element_line(size = 1.2),
        panel.grid.major.y = element_line(size = 0.5))
```

```{r}

```

```{r}
#| label: fig-collisions-type
#| fig-cap: Proportion of each type of traffic collisions (2014â€“2024).
#| echo: false

collision_summary <- data %>%
  summarise(Injury_Collisions = sum(INJURY_COLLISIONS == "YES"),
            FTR_Collisions = sum(FTR_COLLISIONS == "YES"),
            PD_Collisions = sum(PD_COLLISIONS == "YES"))

collision_summary_long <- collision_summary %>%
  pivot_longer(cols = everything(), names_to = "Collision_Type", 
               values_to = "Count") %>%
  mutate(Collision_Type = recode(Collision_Type, 
                                 "Injury_Collisions" = "Injury Collisions",
                                 "FTR_Collisions" = 
                                   "Failed to Remain Collisions",
                                 "PD_Collisions" = 
                                   "Property Damage Collisions"))

collision_summary_long <- collision_summary_long %>%
  mutate(Percentage = round(Count / sum(Count) * 100, 2))

ggplot(collision_summary_long, aes(x = "", y = Count, fill = Collision_Type)) +
  geom_bar(stat = "identity", width = 1) +
  coord_polar("y", start = 0) +
  geom_text(aes(label = paste0(Percentage, "%")), 
            position = position_stack(vjust = 0.5)) +
  scale_fill_manual(values = c("Injury Collisions" = "lightblue", 
                               "Failed to Remain Collisions" = "skyblue", 
                               "Property Damage Collisions" = "#4682B4")) +
  theme_void() +
  labs(title = "Proportion of Each Collision Type") +
  theme(legend.title = element_blank(),
        plot.title = element_text(hjust = 0.5))
```


```{r}
#| label: fig-fatalities-by-year
#| fig-cap: Yearly trend in fatalities from collisions
#| echo: false

data %>%
  group_by(OCC_YEAR) %>%
  summarize(Total_Fatalities = sum(FATALITIES, na.rm = TRUE)) %>%
  ggplot(aes(x = OCC_YEAR, y = Total_Fatalities)) +
  geom_line(color = "darkred", size = 1) +
  scale_x_continuous(breaks = seq(min(data$OCC_YEAR), 
                                  max(data$OCC_YEAR), by = 1)) +  
  theme_minimal() +
  labs(title = "Fatalities by Year", 
       x = "Year", 
       y = "Number of Fatalities") +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    plot.title = element_text(hjust = 0.5, size = 14),
    panel.grid.major.x = element_line(size = 0.8, color = "lightgrey")
  )
```



```{r}












```


```{r}












```


```{r}












```
\newpage
# Discussion {#sec-discussion}
Overall, the analysis of traffic collisions from 2014 to 2024 reveals several key trends. Traffic collisions are more frequent during certain months of the year, with higher occurrences during the winter months, potentially due to hazardous road conditions. The distribution of collisions by hour of the day indicates that rush hours experience the highest number of collisions. The relationship between fatalities and injury collisions suggests that even non-fatal collisions result in significant injuries, emphasizing the need for road safety interventions.

# Conclusion {#sec-conclusion}
This analysis highlights the importance of studying traffic collision data to inform policy decisions and road safety measures. Further analysis could include a more detailed breakdown by specific neighborhoods or examining the impact of weather conditions on collision frequency.


\newpage


# References

